(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{196:function(e,t,o){var content=o(199);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(107).default)("19d59658",content,!0,{sourceMap:!1})},197:function(e,t,o){"use strict";o(108),o(193),o(32),o(18),o(194),o(53),o(33),o(54),o(34);var r=o(6);t.a={data:function(){return{daySelected:null,dailyTemperature:null,showDateInfo:!1,calculatedDates:[],created:!1,calendar:null,visitedYearSet:new Set,dates:[{key:"blue",popover:{label:"Temperatura mitja >1.5º per baix del normal"},highlight:{contentClass:"anomaly-cold--1",fillMode:"light"},dates:[]},{key:"indigo",popover:{label:"Temperatura mitja >3.5º per baix del normal"},highlight:{contentClass:"anomaly-cold--2",fillMode:"light"},dates:[]},{key:"purple",popover:{label:"Temperatura mitja >5º per baix del normal"},highlight:{contentClass:"anomaly-cold--3",fillMode:"light"},dates:[]},{key:"red",popover:{label:"Temperatura mitja >5º per dalt del normal"},highlight:{contentClass:"anomaly-hot--3",fillMode:"light"},dates:[]},{key:"orange",popover:{label:"Temperatura mitja >3.5º per dalt del normal"},highlight:{contentClass:"anomaly-hot--2",fillMode:"light"},dates:[]},{key:"yellow",popover:{label:"Temperatura mitja >1.5º per dalt del normal"},highlight:{contentClass:"anomaly-hot--1",fillMode:"light"},dates:[]},{key:"normal",popover:{label:"Temperatura mitja normal per a la data"},highlight:{contentClass:"normal",fillMode:"light"},dates:[]}],colorPalette:["purple","indigo","blue","normal","yellow","orange","red"],colorMapRange:[-5,-3.5,-1.5,1.5,3.5,5]}},fetchOnServer:!1,fetch:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.requestData();case 2:t.sent,e.calculateCurrentYearAnomalies(e.year);case 4:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;this.visitedYearSet.add(this.year),this.created=!0,this.$nextTick((function(){e.calendar=e.$refs.calendar,2020===e.year&&e.calendar.focusDate&&e.calendar.focusDate(new Date)}))},methods:{requestData:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var o,r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=2020===e.year?"":"-".concat(e.year),t.next=3,fetch("".concat("./","daily-temperatures").concat(o,".json"),{method:"GET",mode:"cors",cache:"force-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"origin"});case 3:return r=t.sent,t.next=6,r.json();case 6:return e.dailyTemperature=t.sent,t.next=9,fetch("./weekly-avg.json",{method:"GET",mode:"cors",cache:"force-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"origin"});case 9:return n=t.sent,t.next=12,n.json();case 12:return e.weekOfYearAvg=t.sent,t.abrupt("return",!0);case 14:case"end":return t.stop()}}),t)})))()},onYearChange:function(e){e.year!==this.year||!0!==this.create?this.$router.push("/".concat(e.year)):this.created=!1},clearCalculatedAnomalies:function(){this.dates.forEach((function(e){e.dates=[]}))},calculateCurrentYearAnomalies:function(e){var t=this,o=new Date("01-01-".concat(e)),r=new Date;2020!==e&&new Date("12-31-".concat(e));for(var n=0,l=function(){var e=new Date(o),r=t.calculateDayAnomaly(o,n);n++;var l=t.getDayColorFromAnomaly(r),c=t.dates.find((function(e){return e.key===l}));c&&c.dates.push(e),o.setDate(o.getDate()+1)};o<r;)l();this.calculatedDates=this.dates},getDayColorFromAnomaly:function(e){return e<this.colorMapRange[0]?this.colorPalette[0]:e>=this.colorMapRange[0]&&e<this.colorMapRange[1]?this.colorPalette[1]:e>=this.colorMapRange[1]&&e<this.colorMapRange[2]?this.colorPalette[2]:e>=this.colorMapRange[2]&&e<this.colorMapRange[3]?this.colorPalette[3]:e>=this.colorMapRange[3]&&e<this.colorMapRange[4]?this.colorPalette[4]:e>=this.colorMapRange[4]&&e<=this.colorMapRange[5]?this.colorPalette[5]:this.colorPalette[6]},calculateDayAnomaly:function(e,t){try{var o=this.getWeekNumber(e),r=this.weekOfYearAvg.aggregations[2].buckets.find((function(e){return e.key===o}))[1].value;return this.dailyTemperature.hits.hits[t]._source.t_avg-r}catch(e){return null}},getDayTemperatures:function(e){var t=this.getWeekNumber(e.date),o=Math.round(Math.abs((e.date-new Date("01-01-".concat(this.year)))/864e5)),r=this.weekOfYearAvg.aggregations[2].buckets.find((function(e){return e.key===t}))[1].value,n=this.dailyTemperature.hits.hits[o]._source.t_avg;console.log(n),console.log(r),this.daySelected={day:e.ariaLabel,dayTemperature:n,normalDayTemperature:r},this.showDateInfo=!0},getWeekNumber:function(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var t=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-t)/864e5+1)/7)}}}},198:function(e,t,o){"use strict";var r=o(196);o.n(r).a},199:function(e,t,o){(t=o(106)(!1)).push([e.i,".modal-mask{position:fixed;z-index:9998;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:table;transition:opacity .3s ease}.modal-wrapper{display:table-cell;vertical-align:middle}.modal-container{width:300px;margin:0 auto;padding:20px 30px;background-color:#fff;border-radius:2px;box-shadow:0 2px 8px rgba(0,0,0,.33);transition:all .3s ease;font-family:Helvetica,Arial,sans-serif}.modal-header h3{margin-top:0;color:#42b983}.modal-body{margin:20px 0}.modal-default-button{float:right}.modal-enter,.modal-leave-active{opacity:0}.modal-enter .modal-container,.modal-leave-active .modal-container{transform:scale(1.1)}.vc-day-content{width:calc(var(--day-content-width) + 10px)!important}",""]),e.exports=t},200:function(e,t,o){"use strict";o.r(t);var r={name:"modal"},n=(o(198),o(28)),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition",{attrs:{name:"modal"}},[o("div",{staticClass:"modal-mask"},[o("div",{staticClass:"modal-wrapper"},[o("div",{staticClass:"modal-container"},[o("div",{staticClass:"modal-header"},[e._t("header",[e._v("\n                  default header\n                ")])],2),e._v(" "),o("div",{staticClass:"modal-body"},[e._t("body",[e._v("\n                  default body\n                ")])],2),e._v(" "),o("div",{staticClass:"modal-footer"},[e._t("footer",[o("button",{staticClass:"modal-default-button",on:{click:function(t){return e.$emit("close")}}},[e._v("\n                    OK\n                  ")])])],2)])])])])}),[],!1,null,null,null);t.default=component.exports},201:function(e,t,o){"use strict";o.r(t);o(202),o(203);var r=o(204),n=o(205),l=o(206),c=o(207),d={components:{homeIcon:r.a,calendarIcon:n.a,articleIcon:l.a,descriptionIcon:c.a}},m=o(28),component=Object(m.a)(d,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"phone-viewport"},[o("md-bottom-bar",{staticClass:"md-accent"},[o("md-bottom-bar-item",[o("home-icon"),e._v(" "),o("span",{staticClass:"md-bottom-bar-label"},[e._v("Inici")])],1),e._v(" "),o("md-bottom-bar-item",[o("calendar-icon"),e._v(" "),o("span",{staticClass:"md-bottom-bar-label"},[e._v("Calendari")])],1),e._v(" "),o("md-bottom-bar-item",[o("article-icon"),e._v(" "),o("span",{staticClass:"md-bottom-bar-label"},[e._v("Mesos")])],1),e._v(" "),o("md-bottom-bar-item",[o("description-icon"),e._v(" "),o("span",{staticClass:"md-bottom-bar-label"},[e._v("Anys")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports},208:function(e,t,o){var content=o(212);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(107).default)("3b7b904e",content,!0,{sourceMap:!1})},211:function(e,t,o){"use strict";var r=o(208);o.n(r).a},212:function(e,t,o){(t=o(106)(!1)).push([e.i,"#app{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:center;color:#2c3e50;margin-top:60px}.normal{background-color:#f7f7f7}.anomaly-hot--1{background-color:#fddbc7}.anomaly-hot--2{background-color:#ef8a62}.anomaly-hot--3{background-color:#b2182b}.anomaly-cold--1{background-color:#d1e5f0}.anomaly-cold--2{background-color:#67a9cf}.anomaly-cold--3{background-color:#2166ac}.vc-rounded-full{border-radius:0!important}.phone-viewport{position:fixed;bottom:1px;width:100vw;z-index:1}.vc-day-content{width:calc(var(--day-content-width) + 10px)!important}.vc-w-full.vc-relative{padding-bottom:3rem}.avoid-back-arrow .vc-arrows-container.title-center>div:first-child,.avoid-forward-arrow .vc-arrows-container.title-center>div:last-child{display:none}",""]),e.exports=t},218:function(e,t,o){"use strict";o.r(t);var r={name:"App",data:function(){return{year:2020}},mixins:[o(197).a]},n=(o(211),o(28)),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[e.created?o("calendar",{ref:"calendar",class:{"avoid-back-arrow":2016===this.year,"avoid-forward-arrow":2020===this.year},attrs:{"from-date":new Date("01-01-"+this.year),"to-date":new Date,attributes:e.calculatedDates,"is-expanded":"",columns:e.$screens({lg:4,md:2},1),rows:e.$screens({lg:3,md:6},12)},on:{dayclick:e.getDayTemperatures,"update:to-page":e.onYearChange,"update:from-page":e.onYearChange}}):e._e(),e._v(" "),e.showDateInfo?o("modal",{on:{close:function(t){e.showDateInfo=!1}}},[e._t("header",[o("h3",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.daySelected.day))])]),e._v(" "),e._t("body",[o("div",{attrs:{slot:"body"},slot:"body"},[o("div",{staticStyle:{"padding-bottom":"1em"}},[e._v(e._s("Temperatura mitja del dia: "+e.daySelected.dayTemperature))]),e._v(" "),o("div",[e._v(e._s("Temperatura mitja habitual de: "+Math.round(100*e.daySelected.normalDayTemperature)/100))])])])],2):e._e(),e._v(" "),o("main-menu")],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Modal:o(200).default,MainMenu:o(201).default})}}]);